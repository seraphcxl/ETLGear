{
    "ETLJobType": {
        "fullOrBlock": "block",
        "needMerge": true,
        "partitionType": 2
    },

    "odpsWorkSpaceName": "wln_ods",
    "bizName": "pos",
    "tableName": "pos_trade",

    "source": {
        "tableCreateSQL": "CREATE TABLE `pos_trade` (
        `trade_uid` varchar(32) NOT NULL COMMENT '门店交易uid',
        `trade_no` varchar(32) NOT NULL COMMENT '门店交易编号',
        `trade_type` tinyint(4) NOT NULL DEFAULT '1' COMMENT '订单类型 1交易单 2 退款单',
        `com_uid` varchar(32) NOT NULL COMMENT '公司uid',
        `shop_uid` varchar(32) NOT NULL COMMENT '店铺uid',
        `status` int(11) NOT NULL COMMENT '订单状态',
        `buyer_uid` varchar(100) NOT NULL COMMENT '买家uid',
        `buyer_name` varchar(128) DEFAULT NULL COMMENT '买家姓名',
        `buyer_nick` varchar(100) DEFAULT NULL,
        `total_money` decimal(19,4) NOT NULL DEFAULT '0.0000' COMMENT '总金额',
        `payment` decimal(19,4) NOT NULL DEFAULT '0.0000' COMMENT '实付金额',
        `advance_pay` decimal(19,4) NOT NULL DEFAULT '0.0000' COMMENT '预收款支付金额',
        `prepaid_card_paid` decimal(19,4) NOT NULL DEFAULT '0.0000' COMMENT '预付卡支付金额',
        `changes` decimal(19,4) NOT NULL DEFAULT '0.0000' COMMENT '找零',
        `post_fee` decimal(19,4) NOT NULL DEFAULT '0.0000' COMMENT '邮费',
        `coupon_fee` decimal(19,4) NOT NULL DEFAULT '0.0000' COMMENT '优惠劵优惠金额',
        `discount_fee` decimal(19,4) NOT NULL DEFAULT '0.0000' COMMENT '优惠金额 包含使用积分折算后的金额',
        `point_used` decimal(19,2) NOT NULL DEFAULT '0.00' COMMENT '使用积分',
        `point_info` varchar(45) DEFAULT NULL COMMENT '积分相关(使用,获得,剩余) 以及微盟积分流水号',
        `create_time` datetime NOT NULL COMMENT '创建时间',
        `pay_time` datetime DEFAULT NULL COMMENT '付款时间',
        `modify_time` datetime NOT NULL COMMENT '最后修改时间',
        `receiver_name` varchar(100) DEFAULT NULL COMMENT '收货人',
        `receiver_state` varchar(50) DEFAULT NULL COMMENT '收货人-省份',
        `receiver_city` varchar(50) DEFAULT NULL COMMENT '收货人-城市',
        `receiver_district` varchar(50) DEFAULT NULL COMMENT '收货人-地区',
        `receiver_address` varchar(200) DEFAULT NULL COMMENT '收货人-详细地址',
        `receiver_zip` varchar(32) DEFAULT NULL COMMENT '收货人-邮编',
        `receiver_mobile` varchar(32) DEFAULT NULL COMMENT '收货人-手机号',
        `receiver_phone` varchar(32) DEFAULT NULL COMMENT '收货人-座机号',
        `buyer_remark` varchar(1000) DEFAULT NULL COMMENT '买家备注',
        `seller_remark` varchar(1000) DEFAULT NULL COMMENT '卖家备注',
        `storage_uid` varchar(32) DEFAULT NULL COMMENT '发货仓库',
        `debt` decimal(19,4) NOT NULL DEFAULT '0.0000' COMMENT '应收账款',
        `settlement` decimal(19,4) NOT NULL DEFAULT '0.0000' COMMENT '已结欠款',
        `pay_type` tinyint(10) DEFAULT NULL COMMENT '支付方式',
        `bill_date` datetime NOT NULL COMMENT '业务时间',
        `salesman` varchar(32) DEFAULT NULL COMMENT '业务员uid',
        `salesman_name` varchar(100) DEFAULT NULL COMMENT '业务员名称',
        `account_uid` varchar(32) DEFAULT NULL COMMENT '账户uid',
        `delivery_type` tinyint(4) DEFAULT '0' COMMENT '配送类型 0:自提,1:快递,2:商家自送',
        `delivery_uid` varchar(32) DEFAULT NULL COMMENT '物流公司uid',
        `delivery_name` varchar(64) DEFAULT NULL COMMENT '物流公司名称',
        `express_no` varchar(45) DEFAULT NULL COMMENT '物流公司单号',
        `oper_uid` varchar(32) DEFAULT NULL COMMENT '操作员uid',
        `oper_name` varchar(100) DEFAULT NULL COMMENT '操作员名称',
        `kind` tinyint(4) DEFAULT NULL COMMENT '销售类型,-1 退货,0:销售,1:零售,2:批发',
        `settlement_type` tinyint(4) NOT NULL DEFAULT '0' COMMENT '已结欠款类型 或预付款类型',
        `his` tinyint(4) DEFAULT '0' COMMENT '是否历史数据生成的数据',
        `sale_inv_uid` varchar(45) DEFAULT NULL COMMENT '出库单uid',
        `salercpt_uid` varchar(45) DEFAULT NULL COMMENT '转配送uid',
        `deposit_uid` varchar(45) DEFAULT NULL COMMENT '转寄存uid',
        `card_id` varchar(96) DEFAULT NULL COMMENT '客户储值卡ID',
        `card_name` varchar(45) DEFAULT NULL COMMENT '客户储值卡名称',
        `sum_cost` decimal(19,4) DEFAULT NULL COMMENT '成本总价',
        `sources` tinyint(4) DEFAULT NULL COMMENT '来源标记',
        `check_status` tinyint(4) NOT NULL DEFAULT '1' COMMENT '审核状态',
        `checked_time` datetime DEFAULT NULL COMMENT '审核时间',
        `dispatch_name` varchar(32) DEFAULT NULL COMMENT '接单员名称',
        `dispatch_id_card_no` varchar(18) DEFAULT NULL COMMENT '接单员身份证号',
        `coupons_amount` decimal(19,4) DEFAULT NULL COMMENT '优惠细化之优惠券优惠金额',
        `points_deduction_amount` decimal(19,4) DEFAULT NULL COMMENT '优惠细化之积分抵扣优惠金额',
        `goods_preferential_amount` decimal(19,4) DEFAULT NULL COMMENT '优惠细化之商品优惠金额',
        `whole_order_discount` decimal(19,4) DEFAULT NULL COMMENT '优惠细化之整单优惠金额',
        `new_logic` tinyint(4) NOT NULL DEFAULT '0' COMMENT '是否为新的交易逻辑(先生成交易单再支付)',
        `flow_no` varchar(64) DEFAULT NULL COMMENT '微盟消费流水号',
        `prepaid_card_bill_ids` varchar(200) NOT NULL DEFAULT '' COMMENT '预付卡支付关联单据ID集合 以#分隔',
        PRIMARY KEY (`trade_uid`),
        UNIQUE KEY `AK_Key_trade_no` (`com_uid`,`trade_no`),
        KEY `IDX_create_time` (`com_uid`,`create_time`),
        KEY `IDX_receiver_name` (`com_uid`,`receiver_name`),
        KEY `IDX_pay_time` (`com_uid`,`pay_time`),
        KEY `idx_modify_time` (`com_uid`,`modify_time`),
        KEY `IDX_BILL_DATE` (`com_uid`,`bill_date`),
        KEY `IDX_cid_sid` (`com_uid`,`sale_inv_uid`) COMMENT '公司编号和出库单编号索引',
        KEY `pos_trade_ix8` (`com_uid`,`salercpt_uid`),
        KEY `pos_trade_ix9` (`com_uid`,`shop_uid`)
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8 ",
        "pkColumnNames": [
            "trade_uid"
        ],
        "createTimeColumnName": "create_time",
        "updateTimeColumnName": "modify_time",
        "splitPkColumnName": "",

        "dataSourceTableName": "pos_trade",
        "dataSource": [
            "crm_01_01",
            "crm_01_02",
            "crm_01_03",
            "crm_01_04",
            "crm_01_05",
            "crm_01_06",
            "crm_01_07",
            "crm_01_08",
            "crm_01_09",
            "crm_02_01",
            "crm_02_02",
            "crm_02_03",
            "crm_02_04",
            "crm_02_05",
            "crm_02_06",
            "crm_02_07",
            "crm_02_08",
            "crm_02_09",
            "crm_02_10",
            "crm_02_11"
        ],
        "where": "",
        "querySql": ""
    },
    "etl": {
        "partition": "dw__src_id=${dw__src_id}",
        "odpsDataSource": "odps_first"
    },
    "ods": {
         "mappingColumns": [
//             {
//                 "mapping": "from_unixtime(SUBSTR(sys_index,1,10))",
//                 "dataType": "DATETIME",
//                 "name": "create_time",
//                 "comment": "创建时间",
//                 "createTime": true
//             },
             {
                 "mapping": "COALESCE(abs(hash(COM_UID)) % 200, 999)",
                 "dataType": "BIGINT",
                 "name": "ods__pt",
                 "comment": "ods__pt",
                 "partitionKey": true
             }
         ],
        "mergeOrderBy": [
            {
                "column": "modify_time",
                "orderBy": "DESC"
            }
        ]
    },
    "schedule": {
        "pull_schedule_minutes": 120,
        "block_merge_schedule_minutes": 480
    }
}